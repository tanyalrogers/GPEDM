<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fit a "fisheries" GP model — fitGP_fish • GPEDM</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fit a " fisheries gp model fitgp_fish><meta property="og:description" content="Fits an alternate version of the GP model with one additonal parameter (catchability),
designed for use in fisheries applications."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GPEDM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9008</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="https://github.com/tanyalrogers/GPEDM" class="external-link">Source Code</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a "fisheries" GP model</h1>
    
    <div class="hidden name"><code>fitGP_fish.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits an alternate version of the GP model with one additonal parameter (catchability),
designed for use in fisheries applications.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fitGP_fish</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">m</span>,</span>
<span>  <span class="va">h</span>,</span>
<span>  z <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pop <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  scaling <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"global"</span>, <span class="st">"local"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  initpars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  modeprior <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  fixedpars <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rhofixed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rhomatrix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  augdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  predictmethod <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  newdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  xname <span class="op">=</span> <span class="st">"escapement"</span>,</span>
<span>  ytrans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"log"</span>, <span class="st">"gr1"</span>, <span class="st">"gr2"</span><span class="op">)</span>,</span>
<span>  bfixed <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>A data frame, required.</p></dd>


<dt>y</dt>
<dd><p>The response variable (required). Typically CPUE.</p></dd>


<dt>m</dt>
<dd><p>Lags of the response variable (required). Typically lags of CPUE.</p></dd>


<dt>h</dt>
<dd><p>Lags of the variable to be multipled by b and subtracted from m (required).
Typically harvest. The dimensions of m and h must match.</p></dd>


<dt>z</dt>
<dd><p>Other predictor variables, e.g. covariates, that are unmodified (optional).</p></dd>


<dt>pop</dt>
<dd><p>Identifies separate populations (optional, if not supplied, defaults to 1
population). Population values can be either numeric, character, or factor.</p></dd>


<dt>time</dt>
<dd><p>The time index (recommended). If not supplied, defaults to a numeric index.</p></dd>


<dt>scaling</dt>
<dd><p>How the variables should be scaled (see Details). Scaling can be <code>"global"</code>
(default), <code>"local"</code> (only applicable if more than 1 pop), or <code>"none"</code>. Scaling is applied
to <code>y</code> and each <code>x</code>. For a mix of scalings, do it manually beforehand and
set scaling to <code>"none"</code>. All outputs are backtransformed to original scale.</p></dd>


<dt>initpars</dt>
<dd><p>Starting values for hyperparameters (see Details) in the order
<code>c(phi,ve,sigma2,rho)</code>, in constrained (non-transformed) space. Should be a numeric
vector with length <code>ncol(x)+3</code>. Defaults used if not supplied: <code>c(rep(0.1,ncol(x)), 0.001, 1-0.001, 0.5)</code></p></dd>


<dt>modeprior</dt>
<dd><p>This value is used by the phi prior and sets the expected number of modes over the unit interval.
Defaults to 1.</p></dd>


<dt>fixedpars</dt>
<dd><p>Fixes values of the hyperparameters phi, ve, and sigma2 (if desired). Should be a numeric
vector with length <code>ncol(x)+2</code> in the order <code>c(phi,ve,sigma2)</code> in constrained
(non-transformed) space. Hyperparameters to estimate should be input as NA. The value of rho is
fixed separately using argument <code>rhofixed</code>.</p></dd>


<dt>rhofixed</dt>
<dd><p>Fixes the rho parameter, if desired (see Details).</p></dd>


<dt>rhomatrix</dt>
<dd><p>Symmetrical square matrix of fixed pairwise rho values to use, with 1's on the diagonal.
The rows and columns should be named with the population identifier.
The output of <code><a href="getrhomatrix.html">getrhomatrix</a></code> can be used here.
All populations in the dataset must appear in <code>rhomatrix</code>. Populations in
<code>rhomatrix</code> that are not in the dataset are allowed and will not be used.</p></dd>


<dt>augdata</dt>
<dd><p>A data frame with augmentation data (see Details).</p></dd>


<dt>predictmethod</dt>
<dd><p>Using the training data, <code>loo</code> does leave-one-out prediction, <code>lto</code> does
leave-timepoint-out prediction, and <code>sequential</code> does sequential (leave-future-out)
prediction.</p></dd>


<dt>newdata</dt>
<dd><p>Data frame containing the same columns supplied in the
original model.</p></dd>


<dt>xname</dt>
<dd><p>What the composite variable m-bh should be called. Defaults to "escapement".</p></dd>


<dt>ytrans</dt>
<dd><p>Tranformation to apply to y before fitting (m remains untransformed).
Either "none" (default), "log", "gr1", or "gr2". R2 is calculated on y in its original
units.</p></dd>


<dt>bfixed</dt>
<dd><p>Fixes b and bypasses optimization.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list (class GP and GPpred) with the same elements as <code><a href="fitGP.html">fitGP</a></code> and with
additonal element <code>b</code>, the names of m, h, z stored under <code>inputs</code>, and the
composite variable (escapement) included in the <code>insampresults</code> table.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This fits a GP model of the form
$$y=f(m-bh,z)$$
where \(y\) is catch per unit effort (CPUE), \(m\) are lags of CPUE, \(h\) are lags of
harvest (in numbers or biomass), \(b\) is catchability (scalar), and \(z\) are
optional covariates. CPUE is assumed proportional to total biomass (or numbers),
with proportionality constant \(b\). The composite variable \(m-bh\) is the biomass or
number of individuals remaining after harvesting (escapement).</p>
<p>Parameter \(b\) is found using <code>optimize</code> applied to the posterior likelihood.
Alternatively, a fixed value for \(b\) can be provided under <code>bfixed</code>.</p>
<p>Parameter <code>ytrans</code> applies a transformation to \(y\) before fitting the model.
Inputs <code>y</code> and <code>m</code> should be in untransformed CPUE. <code>ytrans="none"</code> (the
default) will apply no tranformation, <code>ytrans="log"</code> with compute \(log(y)\),
<code>ytrans="gr1"</code> will compute \(log(y_t/m_{t-1})\), and <code>ytrans="gr2"</code> will
compute \(log(y_t/(m_{t-1}-bh_{t-1})\).</p>
<p>Using this method requires the use of <code>data</code> with pre-generated lags
(option A1 in <code><a href="fitGP.html">fitGP</a></code>). For more details on fitting a fisheries
model and an example see the vignette. For more elaboration on the inputs,
(e.g. <code>scaling</code>, <code>augdata</code>) see <code><a href="fitGP.html">fitGP</a></code>.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stephan Munch, Tanya Rogers.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer></div>

  


  

  </body></html>

