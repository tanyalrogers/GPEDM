<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gaussian Process regression for Empirical Dynamic Modeling • GPEDM</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Gaussian Process regression for Empirical Dynamic Modeling">
<meta property="og:description" content="Functions for fiting hierarchical, separable length scale GP models with
  automatic relevance determination (ARD) for use in Empirical Dynamic Modeling (EDM) 
  and other applications.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">GPEDM</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9006</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="articles/index.html">Vignettes</a>
</li>
<li>
  <a href="https://github.com/tanyalrogers/GPEDM" class="external-link">Source Code</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="gpedm">GPEDM<a class="anchor" aria-label="anchor" href="#gpedm"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p><strong>Disclaimer: This is very much a work in progress. Use at your own risk and please report any problems.</strong></p>
<p>This is version 0.0.0.9006</p>
<p>This package contains functions for fiting hierarchical, separable length scale Gaussian process (GP) models with automatic relevance determination (ARD) for use in Empirical Dynamic Modeling (EDM) and other applications. This is an adaptation of code originally developed by Stephan Munch in MATLAB.</p>
<p>The main function is <code>fitGP</code> which is used to train the model and can also produce predictions if desired. Use <code>summary.GP</code> to view a summary, <code>predict.GP</code> to generate other or additional predictions from a fitted model, <code>plot.GPpred</code> to plot observed and predicted values and <code>getconditionals</code> to obtain conditional reponses. Also available for use are the functions <code>makelags</code> which can be used to create delay vectors, and <code>getR2</code> for getting R2 values. See the <a href="#specifying-training-data">Specifying training data</a> and the vignettes for more detailed instructions.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span> <span class="co">#if required</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"tanyalrogers/GPEDM"</span><span class="op">)</span></span></code></pre></div>
<p>If you are using Windows, you may need to install <a href="https://cran.r-project.org/bin/windows/Rtools/" class="external-link">Rtools</a>, which allows you to complile the C++ code.</p>
</div>
<div class="section level2">
<h2 id="basic-use">Basic Use<a class="anchor" aria-label="anchor" href="#basic-use"></a>
</h2>
<p>Here are some simulated data from 2 populations with theta logistic dynamics. The data contain some small lognormal process noise, and the populations have different theta values.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tanyalrogers.github.io/GPEDM">GPEDM</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"thetalog2pop"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pA</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">thetalog2pop</span>,<span class="va">Population</span><span class="op">==</span><span class="st">"PopA"</span><span class="op">)</span></span>
<span><span class="va">pB</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">thetalog2pop</span>,<span class="va">Population</span><span class="op">==</span><span class="st">"PopB"</span><span class="op">)</span></span>
<span><span class="va">N</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>,mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Abundance</span><span class="op">~</span><span class="va">Time</span>,data<span class="op">=</span><span class="va">pA</span>,type<span class="op">=</span><span class="st">"l"</span>,main<span class="op">=</span><span class="st">"PopA"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Abundance</span><span class="op">~</span><span class="va">Time</span>,data<span class="op">=</span><span class="va">pB</span>,type<span class="op">=</span><span class="st">"l"</span>,main<span class="op">=</span><span class="st">"PopB"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pA</span><span class="op">$</span><span class="va">Abundance</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span>,<span class="va">pA</span><span class="op">$</span><span class="va">Abundance</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="va">N</span><span class="op">]</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Abundance t"</span>,ylab<span class="op">=</span><span class="st">"Abundance t+1"</span>,main<span class="op">=</span><span class="st">"PopA"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pB</span><span class="op">$</span><span class="va">Abundance</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">N</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span>,<span class="va">pB</span><span class="op">$</span><span class="va">Abundance</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="va">N</span><span class="op">]</span>,</span>
<span>     xlab<span class="op">=</span><span class="st">"Abundance t"</span>,ylab<span class="op">=</span><span class="st">"Abundance t+1"</span>,main<span class="op">=</span><span class="st">"PopB"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-data-1.png" width="100%"></p>
<p>Here is how you might set up a hierarchical time-delay embedding model. In this example, <code>Abundance</code> is the response variable (<code>y</code>). We will use an embedding dimension (<code>E</code>) of 3 and time delay (<code>tau</code>) of 1. <code>Population</code> indicates which population the data are from, so it is included under <code>pop</code>. Since the data are on somewhat different scales and don’t necessarily represent the same ‘units’, we will use local (within population) data scaling, as opposed to global. Just for fun, we will also request leave-one-out predictions.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tlogtest</span><span class="op">=</span><span class="fu"><a href="reference/fitGP.html">fitGP</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">thetalog2pop</span>, y <span class="op">=</span> <span class="st">"Abundance"</span>, pop <span class="op">=</span> <span class="st">"Population"</span>, E<span class="op">=</span><span class="fl">3</span>, tau<span class="op">=</span><span class="fl">1</span>, </span>
<span>               scaling <span class="op">=</span> <span class="st">"local"</span>, predictmethod <span class="op">=</span> <span class="st">"loo"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tlogtest</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of predictors: 3 </span></span>
<span><span class="co">#&gt; Length scale parameters:</span></span>
<span><span class="co">#&gt;        predictor posteriormode</span></span>
<span><span class="co">#&gt; phi1 Abundance_1         0.529</span></span>
<span><span class="co">#&gt; phi2 Abundance_2         0.000</span></span>
<span><span class="co">#&gt; phi3 Abundance_3         0.000</span></span>
<span><span class="co">#&gt; Process variance (ve): 0.01221358</span></span>
<span><span class="co">#&gt; Pointwise prior variance (sigma2): 2.53986</span></span>
<span><span class="co">#&gt; Number of populations: 2</span></span>
<span><span class="co">#&gt; Dynamic correlation (rho): 0.3250464</span></span>
<span><span class="co">#&gt; In-sample R-squared: 0.9933951 </span></span>
<span><span class="co">#&gt; In-sample R-squared by population:</span></span>
<span><span class="co">#&gt;             R2</span></span>
<span><span class="co">#&gt; PopA 0.9970774</span></span>
<span><span class="co">#&gt; PopB 0.9815181</span></span>
<span><span class="co">#&gt; Out-of-sample R-squared: 0.991239</span></span>
<span><span class="co">#&gt; Out-of-sample R-squared by population:</span></span>
<span><span class="co">#&gt;             R2</span></span>
<span><span class="co">#&gt; PopA 0.9961232</span></span>
<span><span class="co">#&gt; PopB 0.9754852</span></span></code></pre></div>
<p>From the summary, we can see that ARD has (unsurprisingly) deemed lags 2 and 3 to be unimportant (length scales are 0), so E=1 is probably sufficient. The dynamic correlation (rho) tells us the degree to which the dynamics are correlated (they are are rather dissimilar in this case). Since the simulated data don’t contain that much noise, the R-squared values are quite high.</p>
<div class="section level3">
<h3 id="plot-observed-and-predicted-values">Plot observed and predicted values<a class="anchor" aria-label="anchor" href="#plot-observed-and-predicted-values"></a>
</h3>
<p>The observed and predicted values can be found under <code>model$insampresults</code> or <code>model$outsampresults</code>.</p>
<p>We can make a quick plot of the observed and predicted values using <code>plot</code>. Standard error bands are included in the time series plots, although they’re a little hard to see in this example.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tlogtest</span><span class="op">)</span></span>
<span><span class="co">#&gt; Plotting out of sample results.</span></span></code></pre></div>
<p><img src="reference/figures/README-plot1-1.png" width="100%"></p>
<p>To get the in-sample predictions:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tlogtest</span>, plotinsamp <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="co">#&gt; Plotting in sample results.</span></span></code></pre></div>
<p><img src="reference/figures/README-plot2-1.png" width="100%"></p>
<p>If you prefer ggplot:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tlogtest</span><span class="op">$</span><span class="va">insampresults</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">timestep</span>,y<span class="op">=</span><span class="va">predmean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="va">pop</span><span class="op">~</span><span class="va">.</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">predmean</span><span class="op">-</span><span class="va">predfsd</span>,ymax<span class="op">=</span><span class="va">predmean</span><span class="op">+</span><span class="va">predfsd</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">obs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 3 rows containing missing values (geom_path).</span></span></code></pre></div>
<p><img src="reference/figures/README-ggplot-timeseries-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="plot-conditional-responses">Plot conditional responses<a class="anchor" aria-label="anchor" href="#plot-conditional-responses"></a>
</h3>
<p>The function <code>getconditionals</code> will compute and plot conditional responses to each input variable (other input varibles set to their mean value). From this we can also clearly see that lags 2 and 3 have no impact, and we can see how the lag 1 dynamics of the 2 populations differ.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con</span><span class="op">=</span><span class="fu"><a href="reference/getconditionals.html">getconditionals</a></span><span class="op">(</span><span class="va">tlogtest</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-conditionals-1.png" width="100%"></p>
<p>If you prefer ggplot:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#have to convert conditionals output to long format</span></span>
<span><span class="co">#there may be a more concise way to do this</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="va">npreds</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"_yMean"</span>,<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">con</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">conlong1</span><span class="op">=</span><span class="fu">gather</span><span class="op">(</span><span class="va">con</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">npreds</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span>,<span class="va">x</span>,<span class="va">xValue</span>,<span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="va">npreds</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">conlong2</span><span class="op">=</span><span class="fu">gather</span><span class="op">(</span><span class="va">con</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">(</span><span class="va">npreds</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">npreds</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>,<span class="va">ym</span>,<span class="va">yMean</span>,<span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="va">npreds</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">conlong3</span><span class="op">=</span><span class="fu">gather</span><span class="op">(</span><span class="va">con</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">npreds</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="fl">3</span><span class="op">*</span><span class="va">npreds</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>,<span class="va">ys</span>,<span class="va">ySD</span>,<span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="va">npreds</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">conlong</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind.data.frame</a></span><span class="op">(</span><span class="va">conlong1</span>,yMean<span class="op">=</span><span class="va">conlong2</span><span class="op">$</span><span class="va">yMean</span>,ySD<span class="op">=</span><span class="va">conlong3</span><span class="op">$</span><span class="va">ySD</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">conlong</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">xValue</span>,y<span class="op">=</span><span class="va">yMean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">pop</span><span class="op">~</span><span class="va">x</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">yMean</span><span class="op">-</span><span class="va">ySD</span>,ymax<span class="op">=</span><span class="va">yMean</span><span class="op">+</span><span class="va">ySD</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-ggplot-conditionals-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="plot-inverse-length-scales">Plot inverse length scales<a class="anchor" aria-label="anchor" href="#plot-inverse-length-scales"></a>
</h3>
<p>The model hyperparameters are located under <code>model$pars</code>. If you have <span class="math inline"><em>n</em></span> predictors, the first <span class="math inline"><em>n</em></span> values of <code>pars</code> will be the length scales. Note that if you use <code>E</code> and <code>tau</code>, the names of the predictors in the input data frame will be stored under <code>model$inputs$x_names</code>, and the names of the lagged predictors corresponding to the inverse length scales will be stored under <code>model$inputs$x_names2</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">predvars</span><span class="op">=</span><span class="va">tlogtest</span><span class="op">$</span><span class="va">inputs</span><span class="op">$</span><span class="va">x_names2</span></span>
<span><span class="va">npreds</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">predvars</span><span class="op">)</span></span>
<span><span class="va">lscales</span><span class="op">=</span><span class="va">tlogtest</span><span class="op">$</span><span class="va">pars</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">npreds</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">predvars</span><span class="op">)</span>,<span class="va">lscales</span>,xlab<span class="op">=</span><span class="st">"Predictor"</span>,ylab<span class="op">=</span><span class="st">"Inverse length scale"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-ls-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="other-types-of-predictions">Other types of predictions<a class="anchor" aria-label="anchor" href="#other-types-of-predictions"></a>
</h3>
<p>We can use the <code>predict</code> function to get various types of predictions from a fitted model. Leave-one-out, <code>predictmethod = "loo"</code> is one option (above, we got these predictions at the same time we fit the model, but this is not necessary). The following obtains sequential (leave-future-out) predictions using the training data.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#sequential predictions (they should improve over time)</span></span>
<span><span class="va">seqpred</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">tlogtest</span>,predictmethod <span class="op">=</span> <span class="st">"sequential"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">seqpred</span><span class="op">)</span></span>
<span><span class="co">#&gt; Plotting out of sample results.</span></span></code></pre></div>
<p><img src="reference/figures/README-predict-1.png" width="100%"></p>
<p>You could, alternatively, supply new data for which to make predictions. In that case, you would supply a new data frame (<code>newdata</code>). In our example, this data frame which should contain columns <code>Abundance</code> and <code>Population</code>.</p>
<p>A common approach when fitting these models is to split the available data into a training and test dataset. For instance, say we wanted a single-population model for PopA with 2 time lags, and we wanted to use the first 40 data points as training data, and the last 10 points as test data. For that we could do the following.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pAtrain</span><span class="op">=</span><span class="va">pA</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span>,<span class="op">]</span></span>
<span><span class="va">pAtest</span><span class="op">=</span><span class="va">pA</span><span class="op">[</span><span class="fl">41</span><span class="op">:</span><span class="fl">50</span>,<span class="op">]</span></span>
<span><span class="va">tlogtest2</span><span class="op">=</span><span class="fu"><a href="reference/fitGP.html">fitGP</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pAtrain</span>, y <span class="op">=</span> <span class="st">"Abundance"</span>, E<span class="op">=</span><span class="fl">2</span>, tau<span class="op">=</span><span class="fl">1</span>,</span>
<span>                newdata <span class="op">=</span> <span class="va">pAtest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tlogtest2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Plotting out of sample results.</span></span></code></pre></div>
<p><img src="reference/figures/README-predict2-1.png" width="100%"></p>
<p>If you don’t want the first <code>E*tau</code> points getting excluded from your test data, generate the lags beforehand, then split the data (don’t use <code>E</code> and <code>tau</code> options in <code>fitGP</code>). See <a href="#specifying-training-data">Specifying training data</a> (option 1).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pAlags</span><span class="op">=</span><span class="fu"><a href="reference/makelags.html">makelags</a></span><span class="op">(</span><span class="va">pA</span>, y <span class="op">=</span> <span class="st">"Abundance"</span>, E<span class="op">=</span><span class="fl">2</span>, tau<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">pAdata</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">pA</span>,<span class="va">pAlags</span><span class="op">)</span></span>
<span><span class="va">pAtrain</span><span class="op">=</span><span class="va">pAdata</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span>,<span class="op">]</span></span>
<span><span class="va">pAtest</span><span class="op">=</span><span class="va">pAdata</span><span class="op">[</span><span class="fl">41</span><span class="op">:</span><span class="fl">50</span>,<span class="op">]</span></span>
<span><span class="va">tlogtest3</span><span class="op">=</span><span class="fu"><a href="reference/fitGP.html">fitGP</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">pAtrain</span>, y <span class="op">=</span> <span class="st">"Abundance"</span>, x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">pAlags</span><span class="op">)</span>,</span>
<span>                newdata <span class="op">=</span> <span class="va">pAtest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tlogtest3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Plotting out of sample results.</span></span></code></pre></div>
<p><img src="reference/figures/README-predict3-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="making-forecasts">Making forecasts<a class="anchor" aria-label="anchor" href="#making-forecasts"></a>
</h3>
<p>You can construct a forecast matrix using <code>makelags</code> by setting <code>forecast=T</code> and supplying this as <code>newdata</code>. In order to do this (as the code is currently written), you have to generate the lags beforehand for <em>both</em> the training data and the forecast (you cannot use <code>E</code> and <code>tau</code> in <code>fitGP</code>, you have to use <code>makelags</code> for both, and the settings in <code>makelags</code> should match, other than <code>forecast</code>, See <a href="#specifying-training-data">Specifying training data</a> option 1). It is a good idea to include the <code>time</code> argument when doing this.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lags1</span><span class="op">=</span><span class="fu"><a href="reference/makelags.html">makelags</a></span><span class="op">(</span><span class="va">thetalog2pop</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Abundance"</span><span class="op">)</span>,pop<span class="op">=</span><span class="st">"Population"</span>,time<span class="op">=</span><span class="st">"Time"</span>,E<span class="op">=</span><span class="fl">3</span>,tau<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">fore1</span><span class="op">=</span><span class="fu"><a href="reference/makelags.html">makelags</a></span><span class="op">(</span><span class="va">thetalog2pop</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Abundance"</span><span class="op">)</span>,pop<span class="op">=</span><span class="st">"Population"</span>,time<span class="op">=</span><span class="st">"Time"</span>,E<span class="op">=</span><span class="fl">3</span>,tau<span class="op">=</span><span class="fl">1</span>,forecast <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">data1</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">thetalog2pop</span>, <span class="va">lags1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tlogfore</span><span class="op">=</span><span class="fu"><a href="reference/fitGP.html">fitGP</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data1</span>, y <span class="op">=</span> <span class="st">"Abundance"</span>, x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Abundance_1"</span>,<span class="st">"Abundance_2"</span>,<span class="st">"Abundance_3"</span><span class="op">)</span>, </span>
<span>               pop <span class="op">=</span> <span class="st">"Population"</span>, time <span class="op">=</span> <span class="st">"Time"</span>, scaling <span class="op">=</span> <span class="st">"local"</span>, newdata <span class="op">=</span> <span class="va">fore1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tlogfore</span><span class="op">$</span><span class="va">insampresults</span>,<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">timestep</span>,y<span class="op">=</span><span class="va">predmean</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="va">pop</span><span class="op">~</span><span class="va">.</span>, scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">predmean</span><span class="op">-</span><span class="va">predsd</span>,ymax<span class="op">=</span><span class="va">predmean</span><span class="op">+</span><span class="va">predsd</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">obs</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tlogfore</span><span class="op">$</span><span class="va">outsampresults</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">predmean</span><span class="op">)</span>, color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">tlogfore</span><span class="op">$</span><span class="va">outsampresults</span>,</span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">predmean</span><span class="op">-</span><span class="va">predsd</span>,ymax<span class="op">=</span><span class="va">predmean</span><span class="op">+</span><span class="va">predsd</span><span class="op">)</span>,color<span class="op">=</span><span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 3 rows containing missing values (geom_path).</span></span></code></pre></div>
<p><img src="reference/figures/README-forecast-1.png" width="100%"></p>
</div>
</div>
<div class="section level2">
<h2 id="specifying-training-data">Specifying training data<a class="anchor" aria-label="anchor" href="#specifying-training-data"></a>
</h2>
<p>There are several ways that the training data for a model can be specified.</p>
<p>A. supply data frame <code>data</code>, plus column names or indices for <code>y</code> and <code>x</code>.<br>
B. supply a vector for <code>y</code> and a vector or matrix for <code>x</code>.</p>
<p>For each of the above 2 options, there are 3 options for specifying the predictors.</p>
<ol style="list-style-type: decimal">
<li>supplying <code>y</code> and <code>x</code> (omitting <code>E</code> and <code>tau</code>) will use the columns of <code>x</code> as predictors. This allows for the most customization.<br>
</li>
<li>supplying <code>y</code>, <code>E</code>, and <code>tau</code> (omitting <code>x</code>) will use <code>E</code> lags of <code>y</code> (with spacing <code>tau</code>) as predictors. This is equivalent to option 3 with <code>x</code>=<code>y</code>.<br>
</li>
<li>supplying <code>y</code>, <code>x</code>, <code>E</code>, and <code>tau</code> will use <code>E</code> lags of <em>each column</em> of <code>x</code> (with spacing <code>tau</code>) as predictors. Do not use this option if <code>x</code> already contains lags, in that case use option 1.</li>
</ol>
<p>The above example is method A2. Method A1/B1 allows for the most customization of response and predictor variables including mixed embeddings.</p>
<p>Options 2 and 3 exist for convenience, but for the most control over the model and predictions, it is best to use option 1: use <code><a href="reference/makelags.html">makelags()</a></code> to generate any lags beforehand and pass appropriate columns to <code>fitGP</code>, rather than rely on <code>fitGP</code> to generate lags internally. Option A will make more sense if your data are already in a data frame, option B may make more sense if you are doing simulations and just have a bunch of vectors and matrices.</p>
<p>The <code>pop</code> argument is optional in all of the above cases. If omitted, a single population is assumed.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="va">thetalog2pop</span><span class="op">$</span><span class="va">othervar</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">thetalog2pop</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">yvec</span><span class="op">=</span><span class="va">thetalog2pop</span><span class="op">$</span><span class="va">Abundance</span></span>
<span><span class="va">popvec</span><span class="op">=</span><span class="va">thetalog2pop</span><span class="op">$</span><span class="va">Population</span></span>
<span><span class="co">#function 'makelags' can be used to generate a lag matrix</span></span>
<span><span class="co">#be sure to include 'pop' if data contain multiple pops to prevent crossover</span></span>
<span><span class="va">xmat</span><span class="op">=</span><span class="fu"><a href="reference/makelags.html">makelags</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">thetalog2pop</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Abundance"</span>,<span class="st">"othervar"</span><span class="op">)</span><span class="op">]</span>,pop<span class="op">=</span><span class="va">popvec</span>,E<span class="op">=</span><span class="fl">2</span>,tau<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">thetalog2pop2</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">thetalog2pop</span>,<span class="va">xmat</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Method A1</span></span>
<span><span class="va">ma1</span><span class="op">=</span><span class="fu"><a href="reference/fitGP.html">fitGP</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">thetalog2pop2</span>,y<span class="op">=</span><span class="st">"Abundance"</span>,x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Abundance_1"</span>,<span class="st">"othervar"</span><span class="op">)</span>,</span>
<span>         pop<span class="op">=</span><span class="st">"Population"</span>,scaling<span class="op">=</span><span class="st">"local"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Method B1</span></span>
<span><span class="co">#like A1, but your data aren't in a data frame</span></span>
<span><span class="va">mb1</span><span class="op">=</span><span class="fu"><a href="reference/fitGP.html">fitGP</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">yvec</span>,x<span class="op">=</span><span class="va">xmat</span>,pop<span class="op">=</span><span class="va">popvec</span>,scaling<span class="op">=</span><span class="st">"local"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Method B2</span></span>
<span><span class="co">#like A2, but your data aren't in a data frame</span></span>
<span><span class="va">mb2</span><span class="op">=</span><span class="fu"><a href="reference/fitGP.html">fitGP</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">yvec</span>,pop<span class="op">=</span><span class="va">popvec</span>,E<span class="op">=</span><span class="fl">2</span>,tau<span class="op">=</span><span class="fl">1</span>,scaling<span class="op">=</span><span class="st">"local"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Method A3</span></span>
<span><span class="co">#generate lags of multiple predictors internally</span></span>
<span><span class="va">ma3</span><span class="op">=</span><span class="fu"><a href="reference/fitGP.html">fitGP</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">thetalog2pop2</span>,y<span class="op">=</span><span class="st">"Abundance"</span>,x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Abundance"</span>,<span class="st">"othervar"</span><span class="op">)</span>,</span>
<span>         pop<span class="op">=</span><span class="st">"Population"</span>,E<span class="op">=</span><span class="fl">2</span>,tau<span class="op">=</span><span class="fl">1</span>,scaling<span class="op">=</span><span class="st">"local"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ma1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of predictors: 2 </span></span>
<span><span class="co">#&gt; Length scale parameters:</span></span>
<span><span class="co">#&gt;        predictor posteriormode</span></span>
<span><span class="co">#&gt; phi1 Abundance_1        0.5208</span></span>
<span><span class="co">#&gt; phi2    othervar        0.0003</span></span>
<span><span class="co">#&gt; Process variance (ve): 0.01031384</span></span>
<span><span class="co">#&gt; Pointwise prior variance (sigma2): 2.539001</span></span>
<span><span class="co">#&gt; Number of populations: 2</span></span>
<span><span class="co">#&gt; Dynamic correlation (rho): 0.2929397</span></span>
<span><span class="co">#&gt; In-sample R-squared: 0.994516 </span></span>
<span><span class="co">#&gt; In-sample R-squared by population:</span></span>
<span><span class="co">#&gt;             R2</span></span>
<span><span class="co">#&gt; PopA 0.9971648</span></span>
<span><span class="co">#&gt; PopB 0.9855420</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mb1</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of predictors: 4 </span></span>
<span><span class="co">#&gt; Length scale parameters:</span></span>
<span><span class="co">#&gt;        predictor posteriormode</span></span>
<span><span class="co">#&gt; phi1 Abundance_1       0.50900</span></span>
<span><span class="co">#&gt; phi2 Abundance_2       0.00000</span></span>
<span><span class="co">#&gt; phi3  othervar_1       0.00028</span></span>
<span><span class="co">#&gt; phi4  othervar_2       0.00000</span></span>
<span><span class="co">#&gt; Process variance (ve): 0.01026833</span></span>
<span><span class="co">#&gt; Pointwise prior variance (sigma2): 2.671209</span></span>
<span><span class="co">#&gt; Number of populations: 2</span></span>
<span><span class="co">#&gt; Dynamic correlation (rho): 0.2873044</span></span>
<span><span class="co">#&gt; In-sample R-squared: 0.9945253 </span></span>
<span><span class="co">#&gt; In-sample R-squared by population:</span></span>
<span><span class="co">#&gt;             R2</span></span>
<span><span class="co">#&gt; PopA 0.9971060</span></span>
<span><span class="co">#&gt; PopB 0.9856004</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mb2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of predictors: 2 </span></span>
<span><span class="co">#&gt; Length scale parameters:</span></span>
<span><span class="co">#&gt;      posteriormode</span></span>
<span><span class="co">#&gt; phi1       0.53027</span></span>
<span><span class="co">#&gt; phi2       0.00000</span></span>
<span><span class="co">#&gt; Process variance (ve): 0.01205433</span></span>
<span><span class="co">#&gt; Pointwise prior variance (sigma2): 2.53792</span></span>
<span><span class="co">#&gt; Number of populations: 2</span></span>
<span><span class="co">#&gt; Dynamic correlation (rho): 0.3250085</span></span>
<span><span class="co">#&gt; In-sample R-squared: 0.9935198 </span></span>
<span><span class="co">#&gt; In-sample R-squared by population:</span></span>
<span><span class="co">#&gt;             R2</span></span>
<span><span class="co">#&gt; PopA 0.9971162</span></span>
<span><span class="co">#&gt; PopB 0.9817038</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ma3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Number of predictors: 4 </span></span>
<span><span class="co">#&gt; Length scale parameters:</span></span>
<span><span class="co">#&gt;        predictor posteriormode</span></span>
<span><span class="co">#&gt; phi1 Abundance_1       0.50900</span></span>
<span><span class="co">#&gt; phi2 Abundance_2       0.00000</span></span>
<span><span class="co">#&gt; phi3  othervar_1       0.00028</span></span>
<span><span class="co">#&gt; phi4  othervar_2       0.00000</span></span>
<span><span class="co">#&gt; Process variance (ve): 0.01026833</span></span>
<span><span class="co">#&gt; Pointwise prior variance (sigma2): 2.671209</span></span>
<span><span class="co">#&gt; Number of populations: 2</span></span>
<span><span class="co">#&gt; Dynamic correlation (rho): 0.2873044</span></span>
<span><span class="co">#&gt; In-sample R-squared: 0.9945253 </span></span>
<span><span class="co">#&gt; In-sample R-squared by population:</span></span>
<span><span class="co">#&gt;             R2</span></span>
<span><span class="co">#&gt; PopA 0.9971060</span></span>
<span><span class="co">#&gt; PopB 0.9856004</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="variable-timestep-method-for-missing-data">Variable Timestep Method (for missing data)<a class="anchor" aria-label="anchor" href="#variable-timestep-method-for-missing-data"></a>
</h2>
<p>See the <a href="https://tanyalrogers.github.io/GPEDM/articles/vtimestep.html">vignette</a> for more detail about the variable timestep method (VS-EDM) for missing data.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Munch, S. B., Poynor, V., and Arriaza, J. L. 2017. Circumventing structural uncertainty: a Bayesian perspective on nonlinear forecasting for ecology. Ecological Complexity, 32:134.</p>
<p>Johnson, B., and Munch, S. B. 2022. An empirical dynamic modeling framework for missing or irregular samples. Ecological Modelling, 468:109948.</p>
<p><em>Any advice on improving this package is appreciated.</em></p>
<hr>
</div>
<div class="section level2">
<h2 id="disclaimer">Disclaimer<a class="anchor" aria-label="anchor" href="#disclaimer"></a>
</h2>
<p>The United States Department of Commerce (DOC) GitHub project code is provided on an ‘as is’ basis and the user assumes responsibility for its use. DOC has relinquished control of the information and no longer has responsibility to protect the integrity, confidentiality, or availability of the information. Any claims against the Department of Commerce stemming from the use of its GitHub project will be governed by all applicable Federal law. Any reference to specific commercial products, processes, or services by service mark, trademark, manufacturer, or otherwise, does not constitute or imply their endorsement, recommendation or favoring by the Department of Commerce. The Department of Commerce seal and logo, or the seal and logo of a DOC bureau, shall not be used in any manner to imply endorsement of any commercial product or activity by DOC or the United States Government.”</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing GPEDM</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Stephan Munch <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-7471-5429" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Tanya Rogers <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-1253-9903" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Stephan Munch, Tanya Rogers.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
